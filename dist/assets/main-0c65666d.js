import"./modulepreload-polyfill-3cfb730f.js";/* empty css                     */import"./menu-script-9e7969f3.js";const v=(a="")=>axios.get(a,{method:"GET",withCredentials:!0}).then(t=>t.data);function L(a){const t={};for(const o of a){let l=o.day;const r=o.lesson[0],i=r.number;t[l]||(t[l]={number:[],pairs:[]}),t[l].number.includes(i)||t[l].number.push(i);const e=t[l].pairs.find(s=>s.number===i);e?e.lessons.push(r):t[l].pairs.push({number:i,lessons:[r]})}return t}function S(a,t){const o=[];return a.forEach(l=>{l.groups.forEach(r=>{r.days.forEach(i=>{i.lessons.forEach(e=>{r.id===t&&(e[0].group=r.name,o.push({lesson:e,day:i.day}))})})})}),L(o)}function E(a){let t=[],o=0;for(let l of a){t.push({course:l.course,groups:[]});for(let r of l.groups)t[o].groups.push({id:r.id,name:r.name});o+=1}return t}let k=function(a){Object.keys(a).length!=0?(document.querySelector("#not-found-timetable").classList.add("animation"),setTimeout(()=>{document.querySelector("#not-found-timetable").classList.remove("animation"),document.querySelector("#not-found-timetable").style.display="none"},450)):(document.querySelector("#not-found-timetable").style.display="block",document.querySelector("#not-found-timetable").classList.add("animation-reverse"),setTimeout(()=>{document.querySelector("#not-found-timetable").classList.remove("animation-reverse")},500));const t=document.querySelector(".timetable__block");let o=0,l=[];for(let e in a){l.push({day:e,lessons:[]});for(let s of a[e].pairs)for(let n of s.lessons){let b=n.teacher.split(" "),c=b[0],y=b[1].charAt(0),f=b[2].charAt(0),_=c+". "+y+". "+f+".";l[o].lessons.push({number:n.number,name:n.name,cabinet:n.cabinet,teacher:_})}o++}let r="";l.forEach(e=>{r+=`<div id="timetable-item" class="timetable__item">
                          <h2 id="timetable-disable"><span>${e.day}: <span id="date-mon"></span></span><label id="timetable-disable-arrow" style="rotate: 90deg"><img src="public/img/arrow.svg" alt=""></label></h2>`,e.lessons.forEach(s=>{r+=`<div id="timetable-list" class="timetable__list" >
                            <h1>${s.number}</h1>
                            <div class="timetable__row">
                              <div class="timetable__upper__row">
                                <h2 class="lesson__name">${s.name}</h2>
                                <p class="cabinet">${s.cabinet}</p>
                              </div>
                              <div class="timetable__lower__row">
                                <p class="teacher__name">${s.teacher}</p>
                                <p class="lesson__time">${s.time}</p>
                              </div>
                            </div>
                          </div>`}),r+="</div>"}),t.innerHTML=r,document.querySelectorAll("#timetable-item").forEach(e=>{e.querySelectorAll("#timetable-disable").forEach(s=>{s.addEventListener("click",function(){e.querySelectorAll("#timetable-list").forEach(n=>{n.classList.contains("show")?(e.style.gap="0",n.classList.remove("show"),e.querySelector("#timetable-disable-arrow").style.transform="rotate(0deg)"):(e.style.gap="8.21vw",n.classList.add("show"),e.querySelector("#timetable-disable-arrow").style.transform="rotate(-90deg)")})})})})};const q=document.querySelector(".select__space"),T=async()=>{let a=await v("http://localhost:5000/api/timetable"),t=await v("http://localhost:5000/api/timetable_next"),o=E(a);E(t);let l=document.cookie;const i=l.split(";").find(c=>c.trim().startsWith("myArray="));let e=null;i&&(e=i.split("=")[1]);let s=null;e&&(s=JSON.parse(e)),document.querySelector(".loading").style.transition="opacity, .5s",document.querySelector(".loading").style.opacity="0",document.querySelector(".loading").style.zIndex="-1";let n,w,b=[];if(console.log(s),l.length>0){for(let h=0;h<s.length;h++){for(let m=0;m<o.length;m++)for(let g=0;g<o[m].groups.length;g++)if(s[h]==o[m].groups[g].id){n=o[m].groups[g].name,w=o[m].groups[g].id;continue}u=document.createElement("p"),u.innerText=n,u.id=w,u.className="groupName",q.append(u),b.push(u),console.log(q)}p.push(b[0].id);let c=document.getElementById("timetable-group-switch"),y=document.querySelector(".select__space"),f=document.querySelector(".timetable__group__switch");c.addEventListener("click",function(){y.style.display=="flex"?(y.style.display="none",f.style.background="rgba(90, 89, 89, 0.50)"):(y.style.display="flex",f.style.background="#3C3C3C")}),d=S(a,p[0]),k(d),u=document.querySelectorAll(".groupName");let _=document.getElementById("timetable-group-name");await u.forEach((h,m)=>{_.append(u[0]),h.addEventListener("click",function(){p.splice(0,1,h.id),q.append(_.lastChild),_.replaceChildren(u[m]),y.style.display="none",f.style.background="rgba(90, 89, 89, 0.50)",document.querySelector("#week-checkbox").checked?d=S(t,p[0]):d=S(a,p[0]),k(d)})})}else{document.getElementById("timetable-group-name").innerText="пусто";let c=document.createElement("a");c.id="addMoreGroups",c.href="timetable-settings.html",c.innerText="Выберите группу",document.getElementById("menu-page-disabler").appendChild(c),document.querySelector("#addMoreGroups").style.display="block"}document.querySelector("#week-checkbox").addEventListener("change",function(){this.checked?(d=S(t,p[0]),document.querySelector("#week-arrow").style.transform="rotate3d(0, 1, 0, -180deg)",document.querySelector(".week__title").innerText="Следующая неделя"):(document.querySelector("#week-arrow").style.transform="rotate3d(0, 1, 0, 0deg)",d=S(a,p[0]),document.querySelector(".week__title").innerText="Текущая неделя"),document.querySelector(".timetable__block").classList.add("animation"),setTimeout(async()=>{document.querySelector(".timetable__block").classList.remove("animation"),document.querySelector(".timetable__block").classList.add("animation-reverse"),setTimeout(()=>{document.querySelector(".timetable__block").classList.remove("animation-reverse")},450)},450),setTimeout(async()=>{k(d)},480)})};let p=[],u,d;T();
